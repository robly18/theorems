(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28504,        716]
NotebookOptionsPosition[     26256,        671]
NotebookOutlinePosition[     26604,        686]
CellTagsIndexPosition[     26561,        683]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Parallel`Queue`Priority`\>\"", "]"}]], "Input",Exp\
ressionUUID->"529a0a11-cdb8-47a0-941c-1162d2c02305"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "@", "Priority"}], ";", " ", 
  RowBox[{"Clear", "[", "Priority", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Priority", "[", "p_", "]"}], " ", ":=", " ", 
   RowBox[{"-", 
    RowBox[{"p", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HCEIPS", "[", 
   RowBox[{
   "N_", ",", " ", "lambda_", ",", " ", "p_", ",", " ", "rho0_", ",", " ", 
    "T_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eta", ",", " ", "queue", ",", " ", "x", ",", " ", "y", ",", " ", "ed", 
      ",", " ", "t", ",", " ", "ptot", ",", " ", "gen", ",", " ", "accp"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ed", " ", "=", " ", 
      RowBox[{"ExponentialDistribution", "[", 
       RowBox[{"1", "/", "lambda"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eta", " ", "=", " ", "rho0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"queue", " ", "=", " ", 
      RowBox[{"priorityQueue", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"eta", "[", 
           RowBox[{"[", "x", "]"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", " ", "=", " ", 
           RowBox[{"RandomVariate", "[", "ed", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"t", " ", "\[LessEqual]", " ", "T"}], ",", " ", 
            RowBox[{"EnQueue", "[", 
             RowBox[{"queue", ",", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", " ", "t"}], "}"}]}], "]"}], ",", " ", 
            "Null"}], "]"}]}], ",", " ", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "1", ",", " ", "N"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"EmptyQ", "[", "queue", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "t"}], "}"}], " ", "=", " ", 
         RowBox[{"DeQueue", "[", "queue", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptot", " ", "=", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"eta", "[", 
               RowBox[{"[", "y", "]"}], "]"}]}], " ", ")"}], "*", " ", 
            RowBox[{"p", "[", 
             RowBox[{"x", ",", " ", "y"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", " ", "1", ",", " ", "N"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"gen", " ", "=", " ", 
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], " ", "*", " ", "ptot"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"accp", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"[", "y", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"accp", " ", "=", " ", 
              RowBox[{"accp", " ", "+", " ", 
               RowBox[{"p", "[", 
                RowBox[{"x", ",", "y"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"accp", " ", ">", " ", "gen"}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"eta", "[", 
                  RowBox[{"[", "x", "]"}], "]"}], " ", "=", " ", "0"}], ";", 
                " ", 
                RowBox[{
                 RowBox[{"eta", "[", 
                  RowBox[{"[", "y", "]"}], "]"}], "  ", "=", " ", "1"}], ";", 
                " ", 
                RowBox[{"x", " ", "=", " ", "y"}], ";", " ", 
                RowBox[{"Break", "[", "]"}]}], ",", "\[IndentingNewLine]", 
               "\t\t", "Null"}], "]"}]}], "\[IndentingNewLine]", ",", 
            "Null"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"y", ",", " ", "1", ",", " ", "N"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", " ", "=", " ", 
         RowBox[{"t", " ", "+", " ", 
          RowBox[{"RandomVariate", "[", "ed", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", " ", "\[LessEqual]", " ", "T"}], ",", " ", 
          RowBox[{"EnQueue", "[", 
           RowBox[{"queue", ",", " ", 
            RowBox[{"{", 
             RowBox[{"x", ",", "t"}], "}"}]}], "]"}], ",", " ", "Null"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "eta"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.754761148975546*^9, 3.754761215875188*^9}, {
   3.7547612729604516`*^9, 3.754761361646881*^9}, {3.75476151953098*^9, 
   3.7547615460532055`*^9}, {3.754761914278698*^9, 3.7547619361056395`*^9}, {
   3.754762025005965*^9, 3.75476207855342*^9}, 3.754762173001027*^9, {
   3.7547629022263403`*^9, 3.754762999513459*^9}, {3.754763071710116*^9, 
   3.7547630899767585`*^9}, {3.754763173568105*^9, 3.754763296582989*^9}, {
   3.7547636612740746`*^9, 3.7547636708633738`*^9}, {3.7547637139600916`*^9, 
   3.754763752880899*^9}, {3.754763807078907*^9, 3.754763813533941*^9}, {
   3.7547638529164977`*^9, 3.754763975461938*^9}, 3.754764008255694*^9, {
   3.754764161590412*^9, 3.7547641763008566`*^9}, {3.7547642610994263`*^9, 
   3.7547642724685807`*^9}, {3.75476452090427*^9, 3.7547645209990177`*^9}, {
   3.754764576700555*^9, 3.754764594341999*^9}, 3.7547646322025023`*^9, {
   3.7547647259003344`*^9, 3.7547647262742515`*^9}, {3.754764801479556*^9, 
   3.7547648429490414`*^9}, {3.7547649145566483`*^9, 3.754764914909709*^9}, {
   3.7547649935322943`*^9, 3.754764996417328*^9}, {3.754765046050968*^9, 
   3.754765051373291*^9}, 3.754765248331479*^9, {3.75476543722534*^9, 
   3.754765439650854*^9}, {3.7547655270012827`*^9, 3.754765646035987*^9}, 
   3.7547656801118703`*^9, {3.754768790496709*^9, 3.75476879111905*^9}, 
   3.7547701800540133`*^9, {3.754770401405054*^9, 3.7547704018997326`*^9}, {
   3.754770466087298*^9, 3.7547706240556927`*^9}, {3.7547707290599146`*^9, 
   3.75477073025073*^9}, 
   3.754777100318884*^9},ExpressionUUID->"99bccd8e-3d84-4c1a-89ab-\
07b635e6a394"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StartState", "[", 
    RowBox[{"N_", ",", " ", "nu_"}], "]"}], " ", ":=", " ", 
   RowBox[{"RandomSample", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", " ", "nu"}], "]"}], ",", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"N", "-", "nu"}]}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TSim", "[", 
   RowBox[{
   "N_", ",", " ", "lambda_", ",", " ", "T_", ",", " ", "nu_", ",", " ", 
    "attempts_"}], "]"}], ":=", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ss", " ", "=", " ", 
         RowBox[{"StartState", "[", 
          RowBox[{"N", ",", " ", "nu"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Timing", "[", 
         RowBox[{"HCEIPS", "[", 
          RowBox[{"N", ",", " ", "lambda", ",", " ", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], ",", "1"}], "]"}], ",", " ", 
           "ss", ",", " ", "T"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "attempts"}], "}"}]}], "]"}], "/",
    "attempts"}]}]}], "Input",
 CellChangeTimes->{{3.7547640256408987`*^9, 3.7547640723551764`*^9}, {
   3.7547642866426153`*^9, 3.7547643297714014`*^9}, {3.7547643930941563`*^9, 
   3.754764395443341*^9}, {3.7547644655956483`*^9, 3.7547644790672493`*^9}, {
   3.754764544883805*^9, 3.7547645528521156`*^9}, {3.7547646019512615`*^9, 
   3.7547646477110033`*^9}, {3.754764734824729*^9, 3.754764760933259*^9}, {
   3.754764864421702*^9, 3.7547648691756954`*^9}, {3.7547649335851245`*^9, 
   3.754764952830882*^9}, {3.7547649881075935`*^9, 3.754765005438692*^9}, {
   3.754765063141326*^9, 3.7547650777801456`*^9}, {3.7547652798222327`*^9, 
   3.754765303352128*^9}, {3.7547654803530188`*^9, 3.754765486339013*^9}, {
   3.7547656617080793`*^9, 3.7547657600231876`*^9}, {3.754765813568041*^9, 
   3.7547658155646725`*^9}, {3.75476644433016*^9, 3.75476644752763*^9}, 
   3.7547666236358595`*^9, {3.754766745619293*^9, 3.7547667475591073`*^9}, {
   3.7547667961631393`*^9, 3.754766825178556*^9}, {3.7547669037861557`*^9, 
   3.7547669195153646`*^9}, 3.7547669638717875`*^9, {3.754767009074915*^9, 
   3.754767037827029*^9}, {3.7547694451591578`*^9, 3.754769563383297*^9}, {
   3.7547696007906084`*^9, 3.754769743129629*^9}, {3.7547697742240257`*^9, 
   3.754769788700068*^9}, 
   3.7547771062343144`*^9},ExpressionUUID->"ebcea76a-1df5-4ede-8b41-\
5e82c9661ca4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TSim", "[", 
  RowBox[{
  "100", ",", " ", "1", ",", " ", "100", ",", " ", "50", ",", " ", "5"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7547697455252323`*^9, 3.754769755303849*^9}, {
   3.7547697934829845`*^9, 3.7547698312392836`*^9}, {3.754769888939996*^9, 
   3.754769924362752*^9}, 3.754769975768299*^9, {3.7547700277980585`*^9, 
   3.754770057391781*^9}, {3.7547701378438063`*^9, 3.754770142337308*^9}, {
   3.7547701758079004`*^9, 3.75477017705645*^9}, {3.75477024007821*^9, 
   3.7547702497520742`*^9}, {3.754770418839696*^9, 3.7547704286694202`*^9}, {
   3.7547707578738995`*^9, 
   3.7547707754059896`*^9}},ExpressionUUID->"c0bd1c1a-03af-4bd3-892f-\
563091b783b3"],

Cell[BoxData["1.8843750000000001`"], "Output",
 CellChangeTimes->{{3.7547697575683823`*^9, 3.75476982904515*^9}, {
   3.754769880098633*^9, 3.7547699201230884`*^9}, 3.75476996959558*^9, {
   3.7547700353721294`*^9, 3.7547700718024592`*^9}, {3.7547701429389534`*^9, 
   3.7547701547232003`*^9}, 3.7547701876133814`*^9, {3.7547703981460247`*^9, 
   3.7547704309684644`*^9}, 3.754770503093174*^9, 3.7547706270227585`*^9, {
   3.754770754804112*^9, 3.754770784407915*^9}, 3.754771178539399*^9, 
   3.754814806595212*^9},ExpressionUUID->"25b3b313-cf91-4383-af09-\
efaad0fbbe84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"T", ",", " ", 
     RowBox[{"TSim", "[", 
      RowBox[{
      "100", ",", " ", "1", ",", " ", "T", ",", " ", "50", ",", " ", "5"}], 
      "]"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"T", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", " ", "5", ",", " ", "10", ",", " ", "30", ",", " ", "50", ",",
        " ", "75", ",", " ", "100"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.754770787101712*^9, 3.754770811242162*^9}, {
  3.754770850674718*^9, 3.754770870849772*^9}, {3.754770990782075*^9, 
  3.7547710051686068`*^9}},ExpressionUUID->"b4da0a35-f20e-4c11-aa47-\
8266fa02fa13"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0.018750000000000003`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0.09375`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "0.19062500000000002`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "0.55`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "0.9187500000000001`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"75", ",", "1.428125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "2.121875`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7547708859823403`*^9, 3.754771030037109*^9, 
  3.754771207003146*^9, 
  3.754814833821293*^9},ExpressionUUID->"975c6e0c-c8a9-40a9-b996-\
7184cd6b209f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"N", ",", " ", 
     RowBox[{"TSim", "[", 
      RowBox[{
      "N", ",", " ", "1", ",", " ", "100", ",", " ", "25", ",", " ", "5"}], 
      "]"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"N", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "25", ",", " ", "75", ",", " ", "100", ",", " ", "200", ",", " ", "300",
        ",", " ", "400", ",", " ", "500", ",", " ", "600"}], "}"}]}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.7547710639673815`*^9, 3.754771126096251*^9}, {
  3.7547712377171755`*^9, 3.754771238221843*^9}, {3.754771321127338*^9, 
  3.754771332915971*^9}, {3.75477314587927*^9, 3.7547731536561165`*^9}, {
  3.7547732090436225`*^9, 3.75477321334203*^9}, {3.754814761420927*^9, 
  3.7548147644103413`*^9}},ExpressionUUID->"baf9a14a-63ee-435d-a2e3-\
aac4ec05bf49"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"25", ",", "0.4625`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"75", ",", "1.04375`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "1.225`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"200", ",", "1.659375`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"300", ",", "2.73125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"400", ",", "4.0218750000000005`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"500", ",", "4.690625`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"600", ",", "4.996875`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.754771093251075*^9, 3.7547711295619807`*^9}, 
   3.754771210750381*^9, 3.754771250204715*^9, 3.7547713544518623`*^9, 
   3.7547731613457513`*^9, 3.7547732454081364`*^9, 
   3.754814943067027*^9},ExpressionUUID->"d0e2f7e8-c89c-4ec3-a687-\
77fb885112fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nu", ",", " ", 
     RowBox[{"TSim", "[", 
      RowBox[{
      "100", ",", " ", "1", ",", " ", "100", ",", " ", "nu", ",", " ", "5"}], 
      "]"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"nu", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", " ", "5", ",", " ", "10", ",", "25", ",", " ", "50", ",", " ",
        "75", ",", " ", "100"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.754772624377868*^9, 3.754772648272973*^9}, {
  3.7547727151910067`*^9, 
  3.754772716283504*^9}},ExpressionUUID->"3945262e-8ada-4cc3-9057-\
4d90794a79b7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0.046875`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0.23750000000000002`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "0.43125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "1.3218750000000001`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "2.171875`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"75", ",", "2.7125000000000004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "3.63125`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7547726986580286`*^9, 3.754772770901402*^9, 
  3.754814997433977*^9},ExpressionUUID->"16d2b59a-8a52-4af6-bf9f-\
f3e3460b8d10"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"HCELIPS", "[", 
   RowBox[{
   "N_", ",", " ", "lambda_", ",", " ", "p_", ",", " ", "rho0_", ",", " ", 
    "T_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eta", ",", " ", "queue", ",", " ", "x", ",", " ", "y", ",", " ", "ed", 
      ",", " ", "t", ",", " ", "ptot", ",", " ", "gen", ",", " ", "accp", ",",
       " ", "neighbours"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ed", " ", "=", " ", 
      RowBox[{"ExponentialDistribution", "[", 
       RowBox[{"1", "/", "lambda"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eta", " ", "=", " ", "rho0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"queue", " ", "=", " ", 
      RowBox[{"priorityQueue", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"eta", "[", 
           RowBox[{"[", "x", "]"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", " ", "=", " ", 
           RowBox[{"RandomVariate", "[", "ed", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"t", " ", "\[LessEqual]", " ", "T"}], ",", " ", 
            RowBox[{"EnQueue", "[", 
             RowBox[{"queue", ",", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", " ", "t"}], "}"}]}], "]"}], ",", " ", 
            "Null"}], "]"}]}], ",", " ", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "1", ",", " ", "N"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"EmptyQ", "[", "queue", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "t"}], "}"}], " ", "=", " ", 
         RowBox[{"DeQueue", "[", "queue", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"neighbours", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"x", "-", "1"}], ",", " ", "N", ",", " ", "1"}], "]"}], 
           ",", " ", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"x", "+", "1"}], ",", " ", "N", ",", " ", "1"}], "]"}]}],
           "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptot", " ", "=", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"eta", "[", 
               RowBox[{"[", "y", "]"}], "]"}]}], " ", ")"}], "*", " ", 
            RowBox[{"p", "[", 
             RowBox[{"x", ",", " ", "y"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"y", ",", "neighbours"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"gen", " ", "=", " ", 
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], " ", "*", " ", "ptot"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"accp", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"[", "y", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
            ",", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"accp", " ", "=", " ", 
              RowBox[{"accp", " ", "+", " ", 
               RowBox[{"p", "[", 
                RowBox[{"x", ",", "y"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"accp", " ", ">", " ", "gen"}], ",", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"eta", "[", 
                  RowBox[{"[", "x", "]"}], "]"}], " ", "=", " ", "0"}], ";", 
                " ", 
                RowBox[{
                 RowBox[{"eta", "[", 
                  RowBox[{"[", "y", "]"}], "]"}], "  ", "=", " ", "1"}], ";", 
                " ", 
                RowBox[{"x", " ", "=", " ", "y"}], ";", " ", 
                RowBox[{"Break", "[", "]"}]}], ",", "\[IndentingNewLine]", 
               "\t\t", "Null"}], "]"}]}], "\[IndentingNewLine]", ",", 
            "Null"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"y", ",", " ", "neighbours"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", " ", "=", " ", 
         RowBox[{"t", " ", "+", " ", 
          RowBox[{"RandomVariate", "[", "ed", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", " ", "\[LessEqual]", " ", "T"}], ",", " ", 
          RowBox[{"EnQueue", "[", 
           RowBox[{"queue", ",", " ", 
            RowBox[{"{", 
             RowBox[{"x", ",", "t"}], "}"}]}], "]"}], ",", " ", "Null"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "eta"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.754777084818673*^9, 3.7547770870339327`*^9}, {
   3.7547771497816286`*^9, 3.7547772136747255`*^9}, {3.754777387869177*^9, 
   3.7547774203163953`*^9}, 
   3.7547775383321514`*^9},ExpressionUUID->"1dae8f29-873a-4586-bd78-\
6aaf276e774e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TSimE", "[", 
   RowBox[{
   "N_", ",", " ", "lambda_", ",", " ", "T_", ",", " ", "nu_", ",", " ", 
    "attempts_"}], "]"}], ":=", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{"Sum", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ss", " ", "=", " ", 
         RowBox[{"StartState", "[", 
          RowBox[{"N", ",", " ", "nu"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"Timing", "[", 
         RowBox[{"HCELIPS", "[", 
          RowBox[{"N", ",", " ", "lambda", ",", " ", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], ",", "1"}], "]"}], ",", " ", 
           "ss", ",", " ", "T"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "attempts"}], "}"}]}], "]"}], "/",
    "attempts"}]}]], "Input",
 CellChangeTimes->{{3.7547771757257514`*^9, 3.7547771853956113`*^9}, {
  3.754777217833871*^9, 
  3.7547772408125076`*^9}},ExpressionUUID->"d5704f21-5aea-4449-ae7d-\
6396a6bd6ff8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TSimE", "[", 
  RowBox[{
  "1000", ",", " ", "1", ",", " ", "100", ",", " ", "50", ",", " ", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7547772445536675`*^9, 3.7547772540664525`*^9}, {
   3.7547774263002863`*^9, 3.7547774264179397`*^9}, {3.754777593242565*^9, 
   3.7547776037878337`*^9}, {3.7547776633034105`*^9, 3.7547776684346914`*^9}, 
   3.754814790254116*^9},ExpressionUUID->"af0bc9e1-c543-4ba7-b478-\
b5e7cdc2d407"],

Cell[BoxData["0.78125`"], "Output",
 CellChangeTimes->{
  3.754777289431917*^9, 3.754777429131424*^9, {3.754777543307845*^9, 
   3.7547775619689455`*^9}, {3.754777595788739*^9, 3.7547776135126286`*^9}, {
   3.7547776658618913`*^9, 3.754777678828124*^9}, 3.7548147921651*^9, 
   3.7548149982618556`*^9},ExpressionUUID->"d4bd29d7-1501-474d-ac98-\
2baa6f09556b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TSim", "[", 
  RowBox[{
  "1000", ",", " ", "1", ",", " ", "100", ",", " ", "50", ",", " ", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.754777276294285*^9, {3.754777550941435*^9, 3.7547775510541334`*^9}, {
   3.7548147810218782`*^9, 
   3.7548147881780057`*^9}},ExpressionUUID->"57560f2d-e470-40f9-932b-\
0349e38ff656"],

Cell[BoxData["15.65625`"], "Output",
 CellChangeTimes->{
  3.7547772854568605`*^9, {3.75477755503053*^9, 3.7547775655853105`*^9}, 
   3.7548150147083683`*^9},ExpressionUUID->"be63debb-1849-45d9-bb22-\
2d7483f6a124"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", "eta"}], ",", " ", "eta", ",", " ", 
     RowBox[{"TSimE", "[", 
      RowBox[{
       RowBox[{"2", " ", "eta"}], ",", " ", "1", ",", " ", "100", ",", " ", 
       "eta", ",", " ", "3"}], "]"}], ",", " ", 
     RowBox[{"TSim", "[", 
      RowBox[{
       RowBox[{"2", " ", "eta"}], ",", " ", "1", ",", " ", "100", ",", " ", 
       "eta", ",", " ", "3"}], "]"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"eta", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "50", ",", " ", "100", ",", " ", "300", ",", " ", "700", ",", " ", 
       "1000"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.754815897388646*^9, 
  3.7548159684783945`*^9}},ExpressionUUID->"37658cf2-fe54-47e9-a1a5-\
50572b2e1aa9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"100", ",", "50", ",", "0.734375`", ",", "1.8333333333333333`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"200", ",", "100", ",", "1.5729166666666665`", ",", "5.765625`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "600", ",", "300", ",", "5.510416666666666`", ",", 
     "51.104166666666664`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1400", ",", "700", ",", "13.348958333333332`", ",", 
     "232.80729166666666`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2000", ",", "1000", ",", "19.5625`", ",", "485.4114583333333`"}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.754818440927515*^9},ExpressionUUID->"5635b995-e691-4cb2-b43c-\
af7caaa187c1"]
}, Open  ]]
},
WindowSize->{759, 601},
WindowMargins->{{Automatic, 276}, {44, Automatic}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 146, 2, 28, "Input",ExpressionUUID->"529a0a11-cdb8-47a0-941c-1162d2c02305"],
Cell[707, 24, 6808, 150, 542, "Input",ExpressionUUID->"99bccd8e-3d84-4c1a-89ab-07b635e6a394"],
Cell[7518, 176, 2851, 61, 124, "Input",ExpressionUUID->"ebcea76a-1df5-4ede-8b41-5e82c9661ca4"],
Cell[CellGroupData[{
Cell[10394, 241, 700, 13, 28, "Input",ExpressionUUID->"c0bd1c1a-03af-4bd3-892f-563091b783b3"],
Cell[11097, 256, 573, 8, 32, "Output",ExpressionUUID->"25b3b313-cf91-4383-af09-efaad0fbbe84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11707, 269, 699, 18, 28, "Input",ExpressionUUID->"b4da0a35-f20e-4c11-aa47-8266fa02fa13"],
Cell[12409, 289, 729, 20, 52, "Output",ExpressionUUID->"975c6e0c-c8a9-40a9-b996-7184cd6b209f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13175, 314, 875, 21, 28, "Input",ExpressionUUID->"baf9a14a-63ee-435d-a2e3-aac4ec05bf49"],
Cell[14053, 337, 881, 23, 52, "Output",ExpressionUUID->"d0e2f7e8-c89c-4ec3-a687-77fb885112fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14971, 365, 652, 18, 28, "Input",ExpressionUUID->"3945262e-8ada-4cc3-9057-4d90794a79b7"],
Cell[15626, 385, 705, 19, 52, "Output",ExpressionUUID->"16d2b59a-8a52-4af6-bf9f-f3e3460b8d10"]
}, Open  ]],
Cell[16346, 407, 5567, 134, 523, "Input",ExpressionUUID->"1dae8f29-873a-4586-bd78-6aaf276e774e"],
Cell[21916, 543, 1265, 33, 105, "Input",ExpressionUUID->"d5704f21-5aea-4449-ae7d-6396a6bd6ff8"],
Cell[CellGroupData[{
Cell[23206, 580, 452, 9, 28, "Input",ExpressionUUID->"af0bc9e1-c543-4ba7-b478-b5e7cdc2d407"],
Cell[23661, 591, 359, 6, 32, "Output",ExpressionUUID->"d4bd29d7-1501-474d-ac98-2baa6f09556b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24057, 602, 350, 9, 28, "Input",ExpressionUUID->"57560f2d-e470-40f9-932b-0349e38ff656"],
Cell[24410, 613, 215, 4, 32, "Output",ExpressionUUID->"be63debb-1849-45d9-bb22-2d7483f6a124"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24662, 622, 819, 22, 48, "Input",ExpressionUUID->"37658cf2-fe54-47e9-a1a5-50572b2e1aa9"],
Cell[25484, 646, 756, 22, 109, "Output",ExpressionUUID->"5635b995-e691-4cb2-b43c-af7caaa187c1"]
}, Open  ]]
}
]
*)

